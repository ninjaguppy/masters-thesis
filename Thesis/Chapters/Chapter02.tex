%%% Local Variables:
%%% mode: latex
%%% TeX-master: "classicthesis"
%%% End:
\chapter{A Second Attempt}\label{ch:SecondAttempt}
\section{Matrix Universes}%
\label{sec:MatUniv}

Beyond the functional calculus, it becomes useful to construct general functions
on spaces of matrices---to do so, we must make this idea of ``spaces of
matrices'' concrete. The largest such space is the so-called \textbf{Matrix
  Universe}---consisting of \(g\)-tuples of matrices of all sizes:
\[
  \MM^g = \bigcup_{n=1}^\infty (M_n(\CC))^g
\]
By convention, when we consider some
\(X = \left( X_1, \dots , X_g \right) \in \MM^g\), we require that the \(X_i\)
are all the same size. Since \(\MM^g\) is such a large set, we often want to
deal with subsets that still carry some of the implicit structure of \(\MM^g\).
\begin{definition}[Free Set]
  \label{def:FreeSet}
  We say \(D \subset \MM^g\) is a \textbf{free set} (also called an nc set) if it is closed with respect
  to direct sums and unitary conjugation. That it
  \begin{enumerate}
    \item \(X,Y \in D \) means \(X\oplus Y \in D\).
    \item For \(X,U\) like-size matrices with \(U\) unitary and \(X \in D\),
          then \(U X U^* = \left( UX_1U^*, \dots , UX_g U^*  \right) \in D \).
  \end{enumerate}
\end{definition}

For the remainder of this text, \(D\) will denote some free set. Using the
terminology of \cite{pascoeFreeNoncommutativePrincipal2020}, let
\(D_n = D \cap M_n(\CC)^g\) be the level-wise slice of all \(n \times n\)
matrices in \(D\). We say that \(D\) is \textbf{nc-open}\footnote{The topology of \(\MM^g\)
  is still in flux and there is not a canonical topology. See section \ref{sec:TopManUniv} for
  the details } (resp.\ \textbf{connected}, \textbf{simply connected}, \textbf{bounded}) if each \(D_n\) is open
(resp.\ connected, simply connected, bounded). Finally, we say that \(D\) is
\textbf{differentiable} if each \(D_n\) is an open \(C^1\) manifold where the
complex tangent space of every \(X \in D_n\) is all of \(M_n(\CC)^g\).

In the context of \cref{sec:functionalcalc,sec:ExtMuliVarFun}
%
, the domains in the functional calculus were
\(\HH^g = \bigcup_{n=1}^{\infty} {\HH_n}^g\). \(\HH ^g\) is a differentiable a
free set with two connected components.

On \(\MM^{g} \), we define a product that resembles the inner product on
\(\CC^n\). Given \(A,B \in \MM^{g} \) which are \(g\)-tuples of \(n \times n\)
matrices:
\begin{align*}
	\cdot : \MM^{g} \times \MM^{g}  &\longrightarrow M_n(\CC) \\
  \cdot (A,B) = A \cdot B &\longmapsto \sum_{i=1}^g A_i B_i
\end{align*}

{\color{red} James uses this product, but like what in the world is going on
  with it???}

{\color{red} \(tr (A \otimes Id)\) But its more complicated than that bc A is a
``row vector'' of sorts}


\section{Tracial Functions and Uniqueness of the Gradient}%
\label{sec:TracGrad}
Now that we have \(\MM^d\), we can work with general functions on our matrix
universe. As a whole, free analysis is concerned with so-called \emph{free
  functions}, which respect the direct sums and unitary conjugation.
{\color{red} Do they need to be graded?}
\begin{definition}[Free Function]
\label{def:FreeFun}
  A function \(f: D\to \MM^{\color{red} \text{something}}\) is called \textbf{free} if
  \begin{enumerate}
    \item \(f(X\oplus Y)= f(X) \oplus f(Y)\)
    \item \(f(U X U^*) = f(U)f(X)f(U^*)\) where \(X\) and \(U\) are like-size
          and \(U\) is unitary.
  \end{enumerate}
\end{definition}

The two other classes of functions we are concerned with are those that act like
the trace and the determinant:
\begin{definition}[Determinantal Free Function]
  \label{def:DetFreeFun}
  A function \(f: D \to \CC \) is a \textbf{determinantal free function} if
  \begin{enumerate}
    \item \(f(X\oplus Y) = f(X)f(Y)\)
    \item \(f(U X U^*) = f(X)\) where \(X\) and \(U\) are like-size
          and \(U\) is unitary.
  \end{enumerate}
\end{definition}

\begin{definition}[Tracial Free Function]
  \label{def:TrFreeFun}
  A function \(f: D \to \CC \) is a \textbf{tracial free function} if
  \begin{enumerate}
    \item \(f(X\oplus Y) = f(X)+f(Y)\)
    \item \(f(U X U^*) = f(X)\) where \(X\) and \(U\) are like-size
          and \(U\) is unitary.
  \end{enumerate}
\end{definition}

Given a free function of any type, we can define the directional derivative
(Definition \ref{def:DirDeriv}) identically. It is worth noting that, while they
share the moniker of \emph{free}, determinantal and tracial functions are
\emph{not} free functions.
It is only these tracial functions which inherit the gradient mentioned above.
Similarly to traditional multivariable calculus we define the gradient via its
relationship to the directional derivative:
\begin{definition}[Free Gradient]
\label{def:FreeGrad}
  Given a tracial free function \(f\), the free gradient, \(\nabla f\), is the
  unique free function satisfying
  \[
    \tr \left( H \cdot \nabla f(X) \right) = \tr\, Df(X)[H]
  \]
\end{definition}

It is not-at-all obvious that such a \(\nabla f \) should be unique---after all
any linear combination of commutator is has trace zero. {\color{red} should I
  explain this?} In the case that \(f\) is a single-variable function we can
replace \(\nabla f\) with the traditional derivative, \(f'\), as seen in
\cite[Thm 3.3]{pascoeTrace2020}.
\begin{theorem}
  Let \(f: (a,b)\to \RR \) be a \(C^1\) function. Then
  \[
    \tr \, Df(X)[H] = \tr \left( Hf'(X) \right)
  \]
\end{theorem}

The proof in \cite{pascoeTrace2020} simply asserts the uniqueness of a function
\(g(X)\) and then shows that \(g(x)=f'(x)\) for \(x \in (a,b)\). Instead, we can
construct such a \(g\) and recover the theorem along the way:
\begin{proof}

We start with a construction from Bhatia's Matrix Analysis: Let
$f \in C ^{1} (I)$ and define $f ^{[1]} $ on $I \times I$ by
\[
  f^{[1]} (\lambda,\mu) =
  \begin{cases}
    \frac{f(\lambda) - f(\mu)}{\lambda-\mu} & \lambda \neq \mu \\
    f'(\lambda) & \lambda = \mu.
  \end{cases}
\]
We call $f ^{[1]} (\lambda,\mu)$ the \emph{first divided difference} of $f$ at
$(\lambda,\mu)$. If $\Lambda$ is a diagonal matrix with entries
$\{ \lambda_{i}\} $, We may extend $f$ to accept $\Lambda$ by
defining the $(i,j)$-entry of $f ^{[1]} (\Lambda)$ to be
$f ^{[1]} (\lambda_i,\lambda_j)$. If $A$ is a self adjoint matrix with
$A = U \Lambda U ^{*} $, then we define
$f ^{[1]} (A) = U f ^{[1]} (\Lambda) U ^{*} $. Now we borrow a theorem from
Bhatia \cite{bhatiaMatrixAnalysis1997}:
\begin{theorem}[Bhatia V.3.3]

{\color{red} Theorem numbering?}
  Let $f \in C ^{1} (I)$ and let $A$ be a self adjoint matrix with all
  eigenvalues in $I$. Then \[
    Df(A)[H] = f ^{[1]} (A) \circ H,
  \]
  where $\circ$ denotes the Schur-product\footnote{Entrywise} in a basis where $A$ is diagonal.
\end{theorem}

That is, if $A = U   \Lambda U ^{*} $, then
\[
  Df(A)[H] = U \left( f ^{[1]} (\Lambda) \circ (U ^{* } H U) \right)U ^{*}.
\]
%
To prove our claim, we need to take the trace of both sides. Since trace is
invariant under a change of basis, it is clear that
\[
  \tr Df(A)[H] = \tr \left( f ^{[1]} (\Lambda) \circ (U ^{* } H U) \right).
\]
If $U = u_{ij}$, $U ^{*} = \overline{u}_{ij}$ and $H = h_{ij}$, then the
$(i,j)$-entry of $U ^{*}HU$ is
\[
  {(U ^{* } H U)}_{ij} = \overline{u}_{ik}h_{k\ell}u_{\ell j}
\]
Where we sum over the duplicate indices $k$ and $\ell$. While the structure of
$f ^{[1]} (\Lambda)$ is a bit unruly, our diagonal entries are $f'(\lambda)$.
This means that when we take the trace of the Schur product, we have
\[
 \sum_k\sum_\ell \sum_i f'(\lambda_i)\overline{u}_{ik}h_{k\ell}u_{\ell i}
\]
Now consider the matrix product
$U\, \text{diag} \{f'(\lambda_1), \dots ,f'(\lambda_n)\} \,U ^{*} H $. Since one of our terms
is diagonal, the trace of this multiplication is simple:
\[
  \text{tr}\; U \,\text{diag} \{f'(\lambda_1), \dots ,f'(\lambda_n)\}\, U ^{*} H
  = \sum_k\sum_\ell\sum_i  u_{ik}f'(\lambda_k) \overline{u}_{k \ell} h_{\ell i}
\]
Since \(u_{ik}, \overline{u}_{k\ell}, h_{\ell i} \in \CC \) they commute. We can
then relabel our indices
$i \mapsto \ell\; \ell \mapsto k \; k \mapsto i $ to get
\[
  \tr\; U \,\text{diag} \{f'(\lambda_1), \dots ,f'(\lambda_n)\}\, U ^{*} H
  = \sum_k\sum_\ell \sum_i f'(\lambda_i) \overline{u}_{i k} h_{k \ell}u_{\ell i},
\]
So, for every direction \(H\), we have that
$\tr \left( U\, \text{diag} \{f'(\lambda_1), \dots ,f'(\lambda_n)\} \,U ^{*} H\right) =
   \tr \left( f ^{[1]} (\Lambda) \circ (U ^{* } H U) \right). $
{\color{red} overfull hbox :eyeroll:}
By picking the ``correct'' \(H\)\footnote{See example EXAMPLE NUMBER for
  details}, we conclude that our unique quantity \(g(X)\) is
\(U\, \text{diag} \{f'(\lambda_1), \dots ,f'(\lambda_n)\} \,U ^{*} \). But,
recall that \(X=U\Lambda U\) so, in the functional calculus, $g(X) = f'(X)$.
This recovers theorem 3.3 of \cite{pascoeTrace2020} as we have constructed a
\(g\) such that
\[
  \tr \; Df(X)[H] = \tr H g(X)
\]
\end{proof}

With our theorem proven, we turn our attention back to the \(\nabla f\). The
single variable case motivates that \(\nabla f\) should correspond to the
standard gradient from vector calculus. With some work, the above proof lifts
the multi-variable case. It will be instructive, however, to consider a
different proof.

\begin{theorem}[Trace Duality]
Let \(f,g\) be free functions \(\MM^{g} \to \MM^{\tilde{g}} \). If
\(\tr H \cdot f = \tr H \cdot g\) for all tuples \(H\), then \(f=g\).
\end{theorem}

\begin{proof}
  Since the trace relation holds for all $H$, we may choose our $H$ carefully to
  show the equality of $f$ and $g$. Say that $H,f(X),g(X)$ are $g$-tuples of
  matrices---we will first show that $f_1=g_1$ and we will do so entry by entry.
  Let $E_{ij}$ be the matrix will all zeroes and a 1 in the $(i,j)$-entry.  Now
  let $H= (E_{ji},0, \dots ,0)$. So $\tr E_{ji}f_1(X) = \tr E_{ji}g_1(X)$.
  In our products, the only elements on the diagonal are $(f_1(X))_{ij}$ and
  $(g_1(X))_{ij}$, so when we take the trace we have $(f_1(X))_{ij} =(g_1(X))_{ij}$. If we
  do this for every $(i,j)$, we see that $f_1(X)=g_1(X)$. Similarly, we can choose
  \(H = ( 0, E_{ji},0, \dots, 0)\) for each \(i,j\) to show that \(f_2(X)=g_2(X)\) and
  so on. Since \(f(X)=g(X)\) for each \(X \in \MM^{g} \), it follows that \(f=g\).
\end{proof}

Admittedly, there is a slight complication that is overlooked in the above proof
when it comes to the domains of \(f\) and \(g\). Where these domains overlap, we
can consider them as the same function (and therefore \(\nabla f \) is unique)
but if \(f\) is defined on \(D\) and \(g\) is defined on \(\tilde{D}\), then the
above proof only holds on \(D \cap \tilde{D}\). Examples of such \(f\) and \(g\)
abound when considering rational functions, which are explored in {\color{blue}
  THAT SECTION}
\section{The Topology of Matrix Universes }%
\label{sec:TopManUniv}

At the time of writing, there is no ``canonical topology'' for \(\MM^g\). For a
long time it seemed like the \emph{free} topology (to be defined below) was the
obvious choice, but recent work (c.f.\ \cite{pascoeentire2019}) has shown that the free
topology does not put enough structure on \(\MM^g\). See \cite{aglerAspects2016}
for a full treatment of the common topologies on \(\MM^g\).

A naive approach to a topology on \(\MM = \bigcup_n M_n(\CC)\) would be the
disjoint union topology---which is then extended do a topology on \(\MM^g\) via
the product topology. {\color{red} does disjoint union topology ``commute'' with
the product topology?} Notice, however that this ignores a significant amount of
the implicit structure of nc-sets as we get a disconnected space with countable
many connected components. Topologically, this is means that means that
\[
  H_\bullet (D) = \bigoplus_{n \in \NN } H_\bullet(D_n).
\]
At first glance, this seems fine enough, but it ignores the fact that for
\(X \in D\) we require \(X^{\oplus k} \in D\) for all \(k\) and \(U^*XU \in D\)
for all unitary \(U\). {\color{blue} Should define the similarity envelope at
  some point} In a sense, we think of the all the direct sums of \(X\) and its
similarity envelope as ``the same.'' In light of this, if \(\sim\) is the
equivalence relation that \(X\sim Y\) if \(Y = X^{\oplus k}\) or \(Y = U^*XU\)
{\color{red} is this actually an equivalence relation? The second statement is
  immediate but the first isn't an eq.\ rel.},
then any useful topological theory on \(D \subset \MM^g\) should descend to
classic theory on \(\faktor{D}{\sim}\).

{\color{blue} a note on convergence somewhere.}

\subsection{Admissible Topologies}%
\label{sec:admtopo}

In light of the above discussion, we will present some of the candidate
topologies which show some promise in understanding the topology on \(\MM^g\)
and its subsets.
We say that a topology \(\tau\) is \textbf{admissible} if it has a basis of nc
bounded open sets, \(D\) (recall that this means that \(D\) is closed under
direct sums and unitary conjugation, and that each \(D_n\) is a bounded open set
in \(M_n(\CC)^g\)). The finest admissible topology is the so-called \textbf{fine
  topology},
the basis of which consists of \emph{all} nc open sets.

A slightly more restrictive topology (that seems to show some promise in the eyes
of the author) is the \textbf{fat} topology. For \(n \in \NN \),
\(r \in \RR ^+\), and \(X \in \MM^g_n\), we first define a matricial polydisc
\[
  D_n(X,r) := \{A \in \MM^g \mid \max_{1\leq i\leq g} \| X_i-A_i \| <r\}.
\]
Now we sweep \(D_n\) through all direct sum copies of \(X\):
\[
  D(X,r) := \bigcup_{k=1}^\infty D_{kn} (X^{\oplus k},r)
\]
Finally, we take the similarity envelope of \(D(X,r)\)
\[
  F(X,r) :=  \bigcup_{n=1}^\infty \bigcup_{U \in \mathcal{U}_n} U^* \left( D(X,r) \cap \MM^g_n \right) U
\]
Both the fine and the fat topologies admit implicit function theorems.

The final candidate topology is the aforementioned \textbf{free} topology.
Recall that \(\RR \langle x \rangle \) is the algebra of nc polynomials over the
real number and that
\(\RR \langle x \rangle ^{k\times k}\) is the set of \(k \times k\) matrices
with entries in \(\RR \langle x \rangle \). Let
\(\delta \in \RR \langle x \rangle ^{k\times k}\) and define
\[
  G_\delta = \{x \in \MM^{g} \mid \| \delta(x) \| <1\}
\]
The set of all \(G_\delta\) as \(k\) ranges over \(\ZZ ^+\) form the basis for
the free topology. Indeed, any \(X \in \MM^{g} \) is trivially in one of the
\(G_\delta\) (take \(\delta=X\)) and with some work one can show that
\(G_{\delta_1} \cap G_{\delta_2}= G_{\delta_1\oplus \delta_2}\) ({\color{red}
  prove this}) so we do,
indeed, have a basis.

In \cite{aglerGlobal2013}, Agler and McCarthy proved an free analogue of the
Oka-Weil theorem: any holomorphic function on a compact set in the free topology
can be uniformly approximated by polynomials. Unfortunately, it was later proven
in \cite{pascoeentire2019} and \cite{augatCompact2017} that the only compact
sets in the \(\MM^{g} \) are the envelope of finitely many points, trivializing
the result of Agler and McCarthy.

It is the opinion of the author that all of these topologies are definitively
broken. As shown above, the free topology lacks a wealth of compact sets.
The fine topology (and therefore any admissible topology)
fails to be \(T_1\), let alone Hausdorff---notice that any open set containing
\(X\) must also contain \(X\oplus X\). Further, given any free function \(f\)
on an nc-domain \(D\), if \(f\) is locally bounded on each \(D_n\) then \(f\)
is analytic (admits a power series representation.) There are two ways so view
this result: First, one can accept that analytic functions are a dime dozen on
\(\MM^{g} \). Alternatively, one can be skeptical that the topological
structures put on \(\MM^{g} \) are indeed the natural choice. The work of J.E.
Pascoe in \cite{pascoeFreeNoncommutativePrincipal2020} covered in part
\ref{pt:two} seeks to solve some of these issues by extending some of the
concepts of traditional algebraic topology.

For the rest of this thesis, we will be using the conventions mentioned in
\cref{sec:MatUniv}: \( D \subset\MM^{g} \) open if each \(D_n\) is open---these
are precisely the basic open sets in the fine topology.
{\color{red} this is the fine topology, right? or is it just the basic sets? Is
  the topology generated by these just themselves?}


\section{nc Rational Functions}%
\label{sec:ncrational}

{\color{blue} Short review about defining rational functions via equivalence
  classes. We need this bc rational functions give the nc picard group and
  divisors and all that }
